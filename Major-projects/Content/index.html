<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Management System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="admin-section">
        <h2>Admin Section</h2>
        <form id="add-content-form">
            <input type="text" id="content-title" placeholder="Title" required>
            <textarea id="content-body" placeholder="Content" required></textarea>
            <button type="submit">Add Content</button>
        </form>
        <h3>All Content</h3>
        <div id="admin-content-list"></div>
    </div>

    <div id="user-section">
        <h2>User Section</h2>
        <h3>All Content</h3>
        <div id="user-content-list"></div>
    </div>
    <?php
$dsn = 'mysql:host=localhost;dbname=cms';
$username = 'root';
$password = '';

try {
    $db = new PDO($dsn, $username, $password);
} catch (PDOException $e) {
    echo 'Connection failed: ' . $e->getMessage();
    exit;
}

$action = $_GET['action'] ?? null;
$input = json_decode(file_get_contents('php://input'), true);

if ($action === 'add' && $input) {
    $stmt = $db->prepare("INSERT INTO content (title, body) VALUES (:title, :body)");
    $stmt->bindParam(':title', $input['title']);
    $stmt->bindParam(':body', $input['body']);
    $stmt->execute();
    echo json_encode(['success' => true]);
} elseif ($action === 'list') {
    $stmt = $db->query("SELECT * FROM content");
    $content = $stmt->fetchAll(PDO::FETCH_ASSOC);
    echo json_encode(['content' => $content]);
} elseif ($action === 'edit' && $input) {
    $stmt = $db->prepare("UPDATE content SET title = :title, body = :body WHERE id = :id");
    $stmt->bindParam(':title', $input['title']);
    $stmt->bindParam(':body', $input['body']);
    $stmt->bindParam(':id', $input['id']);
    $stmt->execute();
    echo json_encode(['success' => true]);
} elseif ($action === 'delete' && $input) {
    $stmt = $db->prepare("DELETE FROM content WHERE id = :id");
    $stmt->bindParam(':id', $input['id']);
    $stmt->execute();
    echo json_encode(['success' => true]);
} else {
    echo json_encode(['success' => false]);
}
?>


    <script src="script.js"></script>
</body>
</html>
